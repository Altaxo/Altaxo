using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Xunit;

namespace Altaxo.Calc
{

  public class Digamma_Tests
  {
    /// <summary>
    /// Testdata for the digamma function with argument 10^x, with x = -10..10 with a step with of 0.25.
    /// </summary>
    static readonly double[] digamma_testdata = new double[]
    {
    -1.0000000000577215665e10,-5.6234132524807064686e9,-3.1622776607455949964e9,-1.7782794106161384652e9,
    -1.0000000005772156633e9,-5.6234132576756474237e8,-3.162277665940535929e8,-1.7782794158110793577e8,
    -1.0000000057721564845e8,-5.623413309625054369e7,-3.1622777178899406204e7,-1.7782794677604800412e7,
    -1.0000000577215500408e7,-5.6234138291188631903e6,-3.1622782373835240598e6,-1.7782799872536626887e6,
    -1.0000005772140199687e6,-562341.90240308883335,-316228.3432273011085,-177828.51821030707564,
    -100000.57719921568107,-56234.709705448665871,-31623.353765332514355,-17783.37122355649029,
    -10000.577051183514335,-5623.9901750911604336,-3162.8543557796271351,-1778.8557010693527373,
    -1000.5755719318103005,-562.91561949803035698,-316.79979192993375983,-178.39594434570462866,
    -100.5608854578686745,-56.782470799450246291,-32.14914372063632631,-18.271126922749154933,
    -10.423754940411076795,-5.9409228117675673652,-3.3132182611533208843,-1.6850683648890478696,
    -0.57721566490153286061,0.26885909695499735324,0.98492505162720066838,1.6353978296521635298,
    2.2517525890667211076,2.8498508600529527025,3.4379829261862625345,4.0206061642087584843,
    4.6001618527380874002,5.1780021173876007778,5.7548807603225300164,6.3312196025055511555,
    6.9072551956488120521,7.4831203552157402971,8.0588897032628182251,8.6346051821219379938,
    9.2102903711428494036,9.7859585278949115014,10.361617107001571403,10.937270300298314491,
    11.512920464961895087,12.088568926509478658,12.664216430327587845,13.239863395575794141,
    13.815510057964190771,14.391156550042096578,14.966802946347405604,15.54244928879583523,
    16.118095600958318955,16.693741896089764686,17.269388181643954246,17.845034461812456975,
    18.4206807389523654638,18.996327014389170265, 19.571973288868249483, 20.147619562808760030,
    20.7232658364464111561,21.298912109913751915,21.874558383285320115,22.450204656603031449,
    23.0258509298904568402
   };

    [Fact]
    public void Digamma_Test()
    {
      int i; double x;
      for(i=0, x=-10; x<=7; i++, x+=0.25)
      {
        var xx = Math.Pow(10, x);
        var y = SpecialFunctions.DiGamma(xx);

        AssertEx.AreEqual(digamma_testdata[i], y, 0, 1E-12);
      }

    }
  }
}
